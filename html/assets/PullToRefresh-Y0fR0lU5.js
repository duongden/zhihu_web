import{A as e,J as t,X as n,Y as r,b as i,c as a,l as o,m as s,o as c,s as l,t as u,w as d,x as f,y as p}from"./_plugin-vue_export-helper-DKZfpah6.js";import{t as m}from"./MaterialSymbol-BcLKmkdh.js";var h={class:`title`},g={class:`excerpt`},_={class:`footer`},v=u({__name:`FeedCard`,props:{item:Object,isThought:Boolean},emits:[`click`,`userClick`],setup(e){return(t,r)=>(f(),o(`s-card`,{class:`feed-card`,clickable:!0,onClick:r[0]||=n=>t.$emit(`click`,e.item)},[c(`div`,h,n(e.item.title),1),c(`div`,g,n(e.item.excerpt),1),c(`div`,_,n(e.item.target?.author?.name??`未知作者`)+` · `+n(e.item.metrics.likes)+` 赞同 `+n(e.item.metrics.comments)+` 评论`,1)]))}},[[`__scopeId`,`data-v-426a965f`]]),y=u({__name:`LoadingSentinel`,props:[`onLoadMore`],setup(t){let n=t,r=e(null),a=null;return p(()=>{a=new IntersectionObserver(e=>{e[0].isIntersecting&&n.onLoadMore?.()},{threshold:.1}),r.value&&a.observe(r.value)}),i(()=>{a&&a.disconnect()}),(e,t)=>(f(),o(`div`,{ref_key:`sentinelRef`,ref:r,class:`loading-sentinel`},[...t[0]||=[c(`s-circular-progress`,{indeterminate:`true`,style:{width:`24px`,height:`24px`}},null,-1)]],512))}},[[`__scopeId`,`data-v-ac42e7c3`]]),b={class:`ptr-wrapper`},x={class:`spinner-container`},S={key:0,class:`spinner`},C={key:0,class:`footer-state`},w={key:1,class:`no-more-text`},T={key:0,class:`fab-container`},E={class:`fab-group`},D={class:`fab-group`},O=80,k=120,A=u({__name:`PullToRefresh`,props:{onRefresh:{type:Function,required:!0},onLoadMore:{type:Function,default:null},hasMore:{type:Boolean,default:!0}},setup(n){let u=n,h=e(null),g=e(0),_=e(!1),v=e(!1),A=e(!1),j=e(0),M=e(!1),N=()=>{typeof window<`u`&&(A.value=window.innerWidth<768)},P=()=>{let e=h.value;e&&(e.scrollTop>300?v.value=!0:v.value=!1)},F=()=>{let e=h.value;e&&e.scrollTo({top:0,behavior:`smooth`})},I=async()=>{if(!_.value){_.value=!0;try{await u.onRefresh()}finally{_.value=!1}}},L=e=>{let t=h.value;t&&(t.scrollTop<=0?(j.value=e.touches[0].clientY,M.value=!0):M.value=!1)},R=e=>{let t=h.value;if(!M.value||_.value||!t||t.scrollTop>0)return;let n=e.touches[0].clientY-j.value;n>0&&(e.cancelable&&n<k&&e.preventDefault(),g.value=Math.min(n*.5,k))},z=async()=>{if(g.value>O){_.value=!0,g.value=O;try{await u.onRefresh()}finally{_.value=!1,g.value=0}}else g.value=0;M.value=!1},B=()=>{!M.value||_.value||z()};return p(()=>{N(),window.addEventListener(`resize`,N);let e=h.value;e&&(e.addEventListener(`scroll`,P),e.addEventListener(`touchstart`,L,{passive:!0}),e.addEventListener(`touchmove`,R,{passive:!1}),e.addEventListener(`touchend`,B))}),i(()=>{window.removeEventListener(`resize`,N);let e=h.value;e&&(e.removeEventListener(`scroll`,P),e.removeEventListener(`touchstart`,L),e.removeEventListener(`touchmove`,R),e.removeEventListener(`touchend`,B))}),(e,i)=>(f(),o(`div`,b,[c(`s-scroll-view`,{ref_key:`containerRef`,ref:h,class:`scroll-view`},[c(`div`,{class:`loading-indicator`,style:r({transform:`translateY(${g.value-50}px)`,opacity:g.value>5||_.value?1:0,transition:M.value?`none`:`transform 0.3s ease-out, opacity 0.3s`})},[c(`div`,x,[_.value?(f(),o(`div`,S)):(f(),o(`s-icon`,{key:1,style:r({transform:`rotate(${g.value*2}deg)`})},[s(m,{icon:`refresh`,size:24,class:`refresh-icon`})],4))])],4),c(`div`,{class:`content-wrapper`,style:r({transform:`translateY(${g.value}px)`,transition:M.value?`none`:`transform 0.3s ease-out`})},[d(e.$slots,`default`,{},void 0,!0),n.onLoadMore?(f(),o(`div`,C,[n.hasMore&&!_.value?(f(),l(y,{key:0,onLoadMore:n.onLoadMore},null,8,[`onLoadMore`])):n.hasMore?a(``,!0):(f(),o(`div`,w,`没有更多了`))])):a(``,!0)],4)],512),A.value?a(``,!0):(f(),o(`div`,T,[c(`div`,{class:t([`fab-wrapper`,{visible:v.value,hidden:!v.value}])},[c(`div`,E,[c(`s-fab`,{onClick:F},[c(`s-icon`,null,[s(m,{icon:`vertical_align_top`})])]),i[0]||=c(`s-tooltip`,null,`回到顶部`,-1)])],2),c(`div`,D,[c(`s-fab`,{onClick:I,style:r({transform:_.value?`rotate(180deg)`:`none`,transition:`transform 0.5s`})},[c(`s-icon`,null,[s(m,{icon:`refresh`})])],4),i[1]||=c(`s-tooltip`,null,`刷新`,-1)])]))]))}},[[`__scopeId`,`data-v-e3875605`]]);export{v as n,A as t};